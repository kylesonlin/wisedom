import { compileMdx } from "../compile.js";
function renderCard(item) {
  if (!item.frontMatter) {
    return "";
  }
  const { icon, sidebarTitle, title } = item.frontMatter;
  const Icon = icon ? `<${icon}/>` : "null";
  return `<Cards.Card title="${sidebarTitle || title}" href="${item.route}" icon={${Icon}} />`;
}
async function createIndexPage(pageMap) {
  const result = [];
  let hasCards = false;
  for (const item of pageMap) {
    if ("data" in item) {
      continue;
    }
    if (item.type === "separator") {
      if (hasCards) {
        result.push("</Cards>");
        hasCards = false;
      }
      result.push(`## ${item.title}`);
      continue;
    }
    if (!hasCards) {
      hasCards = true;
      result.push("<Cards>");
    }
    result.push(renderCard(item));
  }
  if (hasCards) {
    result.push("</Cards>");
  }
  const rawMdx = result.join("\n");
  const rawJs = await compileMdx(rawMdx);
  return rawJs;
}
function getIndexPageMap(pageMap) {
  const result = [];
  for (const item of pageMap) {
    if ("data" in item) {
      continue;
    }
    if (item.type === "separator") {
      result.push(item);
    } else {
      const lastResult = result.at(-1);
      if (Array.isArray(lastResult)) {
        lastResult.push(item);
      } else {
        result.push([item]);
      }
    }
  }
  return result;
}
export {
  createIndexPage,
  getIndexPageMap
};
